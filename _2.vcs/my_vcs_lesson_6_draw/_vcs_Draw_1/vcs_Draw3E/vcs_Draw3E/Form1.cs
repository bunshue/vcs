using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace vcs_Draw3E
{
    public partial class Form1 : Form
    {
        int W = 250;
        int H = 250;

        //for random color ST
        //Reference : https://home.gamer.com.tw/creationDetail.php?sn=4281924
        private Label[] lb_color = new Label[101];
        Random r = new Random(Guid.NewGuid().GetHashCode());
        private int _R = 0, _G = 0, _B = 0;
        private int lb_color_x = 0, lb_color_y = 0;
        //for random color SP

        public Form1()
        {
            InitializeComponent();
        }

        private void Form1_Load(object sender, EventArgs e)
        {
            show_item_location();

            draw_random_color();
        }

        void show_item_location()
        {
            //設定執行後的表單起始位置
            this.StartPosition = FormStartPosition.Manual;
            this.Location = new System.Drawing.Point(0, 0);

            int x_st;
            int y_st;
            int dx;
            int dy;

            x_st = 20;
            y_st = 20;
            dx = 160;
            dy = 50;

            pictureBox0.Size = new Size(W, H);
            //pictureBox1.Size = new Size(W, H);
            pictureBox1.Size = new Size(280, 200);
            pictureBox2.Size = new Size(W, H);
            pictureBox3.Size = new Size(W, H);
            pictureBox4.Size = new Size(W, H);
            pictureBox5.Size = new Size(W, H);
            pictureBox6.Size = new Size(W, H);
            pictureBox7.Size = new Size(W, H);
            pictureBox8.Size = new Size(W, H);
            pictureBox9.Size = new Size(W, H);


            x_st = 10;
            y_st = 10;
            dx = W + 70;
            dy = H + 45;

            pictureBox0.Location = new Point(x_st + dx * 0, y_st + dy * 0);
            pictureBox1.Location = new Point(x_st + dx * 1, y_st + dy * 0);
            pictureBox2.Location = new Point(x_st + dx * 2, y_st + dy * 0);
            pictureBox3.Location = new Point(x_st + dx * 3, y_st + dy * 0);
            pictureBox4.Location = new Point(x_st + dx * 4, y_st + dy * 0);
            pictureBox5.Location = new Point(x_st + dx * 0, y_st + dy * 1);
            pictureBox6.Location = new Point(x_st + dx * 1, y_st + dy * 1);
            pictureBox7.Location = new Point(x_st + dx * 2, y_st + dy * 1);
            pictureBox8.Location = new Point(x_st + dx * 3, y_st + dy * 1);
            pictureBox9.Location = new Point(x_st + dx * 4, y_st + dy * 1);

            x_st = 1810;
            y_st = 80;
            dx = 120;
            dy = 50;

            richTextBox1.Location = new Point(x_st + dx * 0 - 250, y_st + dy * 12);
            richTextBox1.Size = new Size(340, 380);
            bt_clear.Location = new Point(richTextBox1.Location.X + richTextBox1.Size.Width - bt_clear.Size.Width, richTextBox1.Location.Y + richTextBox1.Size.Height - bt_clear.Size.Height);

            //最大化螢幕
            this.FormBorderStyle = FormBorderStyle.None;
            this.WindowState = FormWindowState.Maximized;
            bt_exit_setup();
        }

        void bt_exit_setup()
        {
            int width = 5;
            int w = 50; //設定按鈕大小 W
            int h = 50; //設定按鈕大小 H

            Button bt_exit = new Button();  // 實例化按鈕
            bt_exit.Size = new Size(w, h);
            bt_exit.Text = "";
            Bitmap bmp = new Bitmap(w, h);
            Graphics g = Graphics.FromImage(bmp);
            Pen p = new Pen(Color.Red, width);
            g.Clear(Color.Pink);
            g.DrawRectangle(p, width + 1, width + 1, w - 1 - (width + 1) * 2, h - 1 - (width + 1) * 2);
            g.DrawLine(p, 0, 0, w - 1, h - 1);
            g.DrawLine(p, w - 1, 0, 0, h - 1);
            bt_exit.Image = bmp;

            bt_exit.Location = new Point(this.ClientSize.Width - bt_exit.Width, 0);
            bt_exit.Click += bt_exit_Click;     // 加入按鈕事件

            this.Controls.Add(bt_exit); // 將按鈕加入表單
            bt_exit.BringToFront();     //移到最上層
        }

        private void bt_exit_Click(object sender, EventArgs e)
        {
            Application.Exit();
        }

        private void bt_clear_Click(object sender, EventArgs e)
        {
            richTextBox1.Clear();
        }

        private void pictureBox0_Paint(object sender, PaintEventArgs e)
        {

        }

        private void pictureBox1_Paint(object sender, PaintEventArgs e)
        {

        }

        private void pictureBox2_Paint(object sender, PaintEventArgs e)
        {

        }

        private void pictureBox3_Paint(object sender, PaintEventArgs e)
        {

        }

        private void pictureBox4_Paint(object sender, PaintEventArgs e)
        {

        }

        private void pictureBox5_Paint(object sender, PaintEventArgs e)
        {

        }

        private void pictureBox6_Paint(object sender, PaintEventArgs e)
        {

        }

        private void pictureBox7_Paint(object sender, PaintEventArgs e)
        {

        }

        private void pictureBox8_Paint(object sender, PaintEventArgs e)
        {

        }

        private void pictureBox9_Paint(object sender, PaintEventArgs e)
        {

        }

        void draw_random_pixel_image()
        {
            int W = pictureBox0.ClientSize.Width;
            int H = pictureBox0.ClientSize.Height;

            //bitmap
            Bitmap bmp = new Bitmap(W, H);

            //random number
            Random rand = new Random();

            //create random pixels
            for (int y = 0; y < H; y++)
            {
                for (int x = 0; x < W; x++)
                {
                    //generate random ARGB value
                    int a = rand.Next(256);
                    int r = rand.Next(256);
                    int g = rand.Next(256);
                    int b = rand.Next(256);

                    //set ARGB value
                    bmp.SetPixel(x, y, Color.FromArgb(a, r, g, b));
                }
            }

            //load bmp in picturebox1
            pictureBox0.Image = bmp;
        }

        private void timer0_Tick(object sender, EventArgs e)
        {
            draw_random_pixel_image();
        }

        //for pictureBox1 ST
        void draw_random_2d_array()
        {
            int W = pictureBox1.ClientSize.Width;
            int H = pictureBox1.ClientSize.Height;
            int max = 0;
            int min = 255;
            int total = 0;
            int average = 0;
            int rms = 0;

            int xx;
            int yy;
            int width;
            int height;

            int i;
            int j;

            int COLUMNS = W / 20;
            int ROWS = H / 20;

            //brightness = new int[,] { { 1, 2, 3, 4, 5 }, { 1 + 2, 2 + 2, 3 + 2, 4 + 2, 5 + 2 }, { 1 + 4, 2 + 4, 3 + 4, 4 + 4, 5 + 4 } };
            //brightness = new int[,] { { 182, 183, 182, 184, 183, 185, 185, 185, 184, 184, 185, 186, 186, 187, 188, 186, 186, 185, 184, 184, 185, 187, 187, 187, 187, 187, 187, 186 }, { 181, 182, 182, 181, 183, 183, 181, 182, 182, 182, 185, 185, 185, 185, 185, 186, 183, 182, 181, 181, 181, 181, 184, 184, 186, 186, 186, 187 }, { 182, 180, 179, 180, 179, 180, 180, 179, 180, 180, 179, 181, 181, 184, 185, 182, 180, 179, 178, 180, 180, 180, 180, 180, 181, 184, 186, 187 }, { 180, 180, 179, 179, 178, 179, 179, 180, 179, 179, 180, 180, 183, 182, 182, 181, 178, 178, 176, 175, 178, 178, 181, 181, 183, 182, 186, 185 }, { 174, 180, 178, 176, 176, 176, 178, 176, 176, 176, 178, 179, 179, 179, 179, 176, 176, 175, 175, 176, 174, 175, 175, 176, 178, 181, 182, 188 }, { 173, 173, 174, 174, 173, 173, 173, 174, 175, 175, 176, 176, 178, 178, 176, 175, 174, 174, 174, 174, 174, 174, 175, 175, 177, 177, 180, 181 }, { 168, 174, 174, 172, 172, 173, 174, 174, 174, 174, 174, 173, 173, 175, 174, 174, 173, 173, 173, 173, 172, 173, 172, 174, 175, 179, 178, 181 }, { 157, 176, 174, 174, 174, 173, 170, 170, 170, 170, 172, 172, 171, 170, 172, 172, 172, 173, 173, 173, 173, 173, 174, 174, 176, 175, 175, 175 }, { 174, 173, 173, 174, 174, 174, 174, 173, 172, 172, 172, 169, 168, 171, 168, 172, 172, 171, 173, 173, 173, 173, 172, 172, 173, 174, 174, 175 }, { 160, 175, 174, 175, 174, 173, 171, 169, 168, 168, 168, 170, 169, 169, 168, 169, 171, 171, 172, 172, 172, 172, 172, 172, 172, 172, 173, 172 }, { 172, 171, 171, 173, 173, 173, 172, 169, 169, 169, 169, 169, 168, 167, 166, 168, 168, 171, 173, 173, 173, 173, 170, 170, 170, 171, 173, 173 }, { 167, 167, 169, 171, 173, 173, 171, 171, 169, 169, 169, 169, 167, 167, 166, 166, 171, 171, 172, 172, 169, 169, 168, 168, 168, 168, 171, 171 }, { 164, 164, 165, 166, 169, 169, 169, 169, 168, 168, 168, 167, 166, 164, 164, 166, 166, 167, 167, 167, 168, 168, 166, 166, 165, 167, 168, 169 }, { 162, 161, 164, 164, 169, 169, 169, 169, 169, 168, 168, 168, 165, 166, 166, 166, 169, 168, 167, 167, 167, 167, 167, 167, 166, 165, 167, 167 }, { 160, 159, 161, 164, 162, 166, 165, 166, 168, 167, 167, 164, 165, 162, 161, 163, 163, 161, 161, 163, 165, 165, 164, 162, 160, 161, 164, 164 }, { 158, 158, 159, 159, 162, 162, 166, 167, 168, 168, 167, 167, 165, 165, 165, 166, 165, 165, 164, 164, 164, 162, 161, 161, 159, 159, 160, 160 }, { 158, 157, 158, 157, 159, 160, 160, 165, 165, 166, 166, 165, 164, 164, 161, 162, 162, 160, 160, 160, 161, 163, 161, 160, 160, 160, 160, 160 }, { 157, 155, 157, 157, 159, 159, 164, 164, 165, 164, 164, 165, 161, 161, 160, 160, 159, 160, 159, 161, 160, 160, 160, 160, 159, 159, 158, 158 }, { 158, 155, 155, 155, 158, 159, 159, 162, 161, 163, 164, 161, 161, 159, 159, 160, 161, 159, 160, 158, 158, 157, 157, 157, 156, 158, 159, 159 }, { 154, 154, 155, 155, 161, 161, 162, 162, 160, 161, 160, 160, 159, 159, 159, 158, 159, 159, 159, 159, 158, 158, 158, 158, 159, 159, 158, 159 }, { 154, 155, 154, 155, 156, 156, 158, 161, 160, 159, 158, 157, 156, 156, 157, 157, 158, 158, 154, 154, 157, 158, 158, 154, 155, 155, 155, 157 }, { 152, 152, 152, 153, 159, 159, 159, 159, 157, 157, 155, 157, 158, 157, 158, 157, 157, 155, 154, 154, 155, 155, 155, 157, 155, 155, 153, 153 }, { 150, 150, 151, 152, 152, 155, 157, 157, 155, 153, 152, 152, 153, 158, 157, 157, 154, 151, 152, 152, 152, 154, 158, 157, 155, 152, 151, 152 }, { 146, 147, 150, 151, 155, 155, 157, 157, 154, 153, 152, 152, 154, 154, 155, 155, 152, 152, 151, 150, 152, 151, 154, 155, 153, 152, 148, 148 }, { 147, 148, 148, 152, 152, 153, 154, 154, 152, 151, 150, 151, 150, 152, 153, 153, 152, 150, 150, 151, 151, 152, 152, 152, 152, 150, 148, 150 }, { 147, 147, 151, 151, 155, 154, 154, 154, 150, 150, 150, 150, 151, 151, 151, 151, 147, 147, 147, 147, 151, 150, 152, 151, 150, 148, 146, 147 }, { 143, 146, 146, 148, 149, 149, 150, 150, 150, 151, 150, 149, 148, 148, 147, 147, 148, 147, 146, 146, 147, 149, 150, 150, 150, 146, 147, 148 }, { 146, 146, 150, 149, 148, 150, 148, 147, 145, 145, 145, 145, 144, 144, 146, 146, 147, 149, 148, 150, 152, 151, 151, 151, 147, 148, 150, 150 } };
            //brightness = new int[,] { { 178, 179, 179, 185, 185, 190, 191, 196, 199, 203, 208, 215, 215, 225, 229, 236, 238, 244, 248, 251, 252, 254, 255, 255, 255, 255, 255, 255 }, { 179, 179, 182, 182, 188, 187, 193, 193, 199, 201, 207, 208, 216, 223, 231, 232, 241, 243, 250, 251, 253, 253, 255, 255, 255, 255, 255, 255 }, { 176, 176, 179, 181, 182, 187, 189, 194, 195, 200, 203, 211, 213, 223, 228, 235, 237, 243, 247, 249, 251, 253, 255, 255, 255, 255, 255, 255 }, { 176, 178, 181, 180, 183, 185, 190, 190, 197, 199, 203, 204, 212, 217, 225, 230, 237, 239, 249, 249, 253, 253, 255, 255, 255, 255, 255, 255 }, { 173, 174, 177, 180, 182, 186, 187, 190, 192, 196, 199, 207, 210, 218, 222, 230, 232, 238, 241, 248, 249, 251, 253, 255, 255, 255, 255, 255 }, { 174, 174, 179, 179, 183, 183, 188, 188, 193, 194, 199, 201, 209, 215, 222, 226, 233, 236, 244, 244, 250, 250, 255, 255, 255, 255, 255, 255 }, { 171, 174, 174, 179, 180, 182, 186, 188, 188, 193, 192, 200, 206, 214, 218, 225, 228, 234, 238, 246, 247, 250, 251, 255, 255, 255, 255, 255 }, { 173, 173, 176, 178, 182, 182, 186, 185, 188, 189, 195, 194, 203, 205, 216, 218, 229, 231, 241, 244, 248, 249, 252, 255, 255, 255, 255, 255 }, { 171, 173, 173, 175, 175, 180, 182, 187, 187, 189, 190, 195, 198, 205, 209, 217, 222, 230, 233, 239, 242, 248, 250, 253, 255, 255, 255, 255 }, { 171, 171, 174, 174, 179, 180, 186, 185, 187, 187, 192, 193, 201, 201, 209, 209, 218, 223, 233, 235, 245, 245, 252, 253, 255, 255, 255, 255 }, { 170, 170, 173, 174, 172, 177, 180, 185, 186, 188, 190, 194, 194, 201, 202, 208, 213, 222, 227, 234, 238, 244, 247, 249, 252, 253, 255, 255 }, { 170, 171, 175, 174, 178, 179, 181, 182, 186, 187, 189, 191, 195, 196, 201, 201, 212, 214, 226, 230, 238, 240, 248, 248, 252, 252, 255, 255 }, { 172, 172, 174, 174, 174, 179, 180, 183, 185, 187, 188, 193, 194, 199, 199, 206, 207, 216, 220, 229, 231, 239, 243, 246, 247, 249, 253, 255 }, { 171, 171, 173, 174, 173, 174, 178, 180, 181, 184, 189, 189, 193, 194, 199, 199, 207, 209, 214, 221, 232, 233, 243, 244, 250, 251, 255, 255 }, { 169, 172, 171, 174, 174, 177, 178, 180, 180, 182, 184, 189, 191, 195, 197, 202, 203, 208, 211, 217, 222, 230, 235, 240, 243, 248, 251, 253 }, { 168, 168, 172, 171, 173, 173, 175, 177, 181, 181, 187, 186, 193, 194, 200, 201, 203, 204, 213, 215, 223, 225, 235, 236, 244, 244, 252, 252 }, { 164, 166, 166, 170, 170, 172, 173, 175, 177, 180, 181, 187, 188, 193, 193, 198, 199, 203, 206, 213, 216, 222, 225, 233, 237, 244, 246, 249 }, { 166, 165, 168, 168, 171, 171, 175, 176, 180, 180, 186, 186, 193, 193, 196, 197, 199, 200, 209, 210, 218, 219, 228, 229, 238, 239, 248, 248 }, { 164, 164, 164, 166, 166, 171, 171, 173, 174, 178, 179, 185, 183, 190, 189, 194, 196, 200, 201, 208, 210, 217, 221, 228, 230, 236, 238, 243 }, { 163, 163, 166, 166, 168, 168, 173, 173, 175, 175, 180, 180, 185, 185, 187, 190, 192, 193, 202, 203, 212, 212, 220, 221, 230, 231, 237, 241 }, { 159, 160, 161, 165, 165, 169, 169, 171, 174, 175, 176, 181, 182, 185, 186, 189, 190, 195, 196, 201, 203, 210, 214, 222, 224, 230, 230, 236 }, { 162, 162, 166, 165, 167, 166, 170, 170, 173, 173, 176, 175, 180, 180, 186, 185, 189, 189, 196, 197, 203, 206, 213, 216, 223, 224, 233, 232 }, { 160, 161, 161, 164, 162, 167, 167, 169, 172, 173, 174, 177, 179, 182, 182, 186, 186, 189, 189, 193, 195, 202, 204, 213, 216, 222, 223, 227 }, { 161, 163, 162, 164, 166, 165, 168, 167, 171, 171, 173, 174, 177, 177, 182, 181, 187, 188, 194, 194, 199, 199, 204, 207, 214, 215, 219, 219 }, { 165, 163, 163, 161, 164, 165, 165, 167, 169, 171, 171, 174, 174, 179, 179, 182, 182, 186, 187, 190, 192, 196, 196, 202, 207, 214, 215, 220 }, { 164, 164, 161, 161, 164, 163, 166, 166, 168, 168, 172, 171, 175, 175, 179, 179, 183, 183, 188, 187, 192, 192, 196, 198, 206, 207, 212, 214 }, { 161, 161, 161, 161, 164, 166, 166, 167, 167, 169, 168, 174, 174, 176, 178, 179, 179, 182, 183, 186, 188, 190, 193, 196, 197, 202, 203, 210 }, { 161, 160, 161, 161, 164, 164, 166, 166, 168, 167, 172, 172, 176, 176, 178, 178, 181, 181, 184, 185, 186, 188, 191, 192, 198, 199, 205, 205 } };

            //brightness = new int[,] { { 255, 255, 255, 222, 209, 214, 212, 209, 195, 218, 231, 244, 246, 239, 242, 245, 247, 241, 239, 224 }, { 254, 255, 255, 222, 210, 221, 214, 215, 211, 222, 231, 237, 242, 246, 249, 249, 249, 236, 237, 239 }, { 255, 255, 252, 228, 229, 221, 209, 214, 207, 222, 228, 240, 243, 248, 249, 252, 252, 236, 231, 238 }, { 253, 253, 246, 235, 230, 238, 222, 218, 221, 223, 233, 246, 249, 253, 253, 255, 253, 253, 253, 253 }, { 253, 252, 248, 236, 236, 229, 226, 220, 220, 226, 231, 243, 249, 252, 252, 254, 253, 254, 254, 253 }, { 252, 254, 248, 239, 234, 231, 227, 227, 225, 227, 234, 240, 250, 252, 252, 253, 252, 254, 254, 255 }, { 252, 255, 249, 235, 235, 228, 228, 225, 224, 229, 229, 241, 246, 255, 253, 255, 255, 255, 255, 254 }, { 250, 251, 240, 240, 232, 233, 230, 232, 232, 234, 232, 219, 225, 240, 239, 242, 247, 252, 253, 252 }, { 251, 249, 240, 235, 235, 232, 232, 223, 231, 227, 229, 226, 222, 238, 238, 241, 235, 246, 251, 250 }, { 252, 249, 234, 241, 236, 236, 236, 240, 247, 242, 253, 221, 213, 236, 236, 238, 245, 248, 251, 251 }, { 252, 248, 230, 235, 234, 236, 238, 241, 244, 246, 249, 239, 237, 250, 242, 245, 246, 250, 250, 250 }, { 252, 248, 229, 238, 240, 240, 241, 240, 245, 247, 250, 241, 239, 252, 250, 252, 251, 251, 251, 251 }, { 254, 246, 236, 235, 236, 238, 239, 241, 240, 246, 249, 244, 242, 248, 249, 250, 250, 251, 251, 250 }, { 248, 245, 239, 238, 236, 234, 234, 234, 238, 239, 245, 247, 247, 248, 249, 249, 251, 250, 249, 251 }, { 245, 240, 239, 236, 236, 233, 233, 231, 234, 238, 241, 247, 247, 247, 249, 249, 249, 250, 253, 250 }, { 228, 234, 235, 236, 235, 233, 230, 229, 233, 236, 246, 248, 248, 246, 244, 246, 248, 249, 249, 250 }, { 230, 237, 237, 236, 236, 230, 229, 229, 227, 239, 241, 247, 248, 246, 246, 246, 246, 244, 239, 236 }, { 230, 231, 235, 235, 234, 233, 229, 230, 227, 243, 253, 252, 252, 250, 246, 244, 237, 237, 229, 234 }, { 233, 236, 236, 236, 235, 232, 230, 231, 228, 242, 247, 249, 249, 249, 247, 241, 241, 237, 236, 235 }, { 237, 239, 236, 236, 235, 234, 230, 226, 224, 255, 255, 255, 255, 252, 231, 236, 240, 238, 235, 236 } };
            /*
            brightness = new int[,] { { 166, 169, 174, 173, 173, 172, 171, 173, 176, 178, 179, 177, 177, 179, 179, 179, 178, 179, 181, 181, 183, 184, 182, 184, 186, 187, 185, 187 }, { 172, 174, 173, 173, 173, 168, 171, 173, 174, 181, 181, 182, 181, 179, 179, 178, 179, 180, 180, 183, 185, 186, 186, 187, 186, 187, 186, 187 }, { 166, 166, 168, 166, 168, 171, 171, 174, 176, 176, 178, 177, 178, 178, 175, 176, 176, 178, 180, 180, 182, 183, 186, 187, 188, 188, 185, 184 }, { 168, 168, 167, 169, 169, 173, 173, 175, 177, 179, 179, 180, 179, 177, 177, 175, 177, 177, 178, 180, 179, 181, 182, 186, 185, 186, 185, 187 }, { 167, 166, 166, 166, 172, 174, 178, 181, 179, 177, 175, 174, 175, 177, 175, 176, 179, 180, 180, 180, 181, 181, 183, 183, 185, 185, 186, 186 }, { 171, 170, 171, 171, 171, 173, 174, 179, 176, 176, 176, 176, 175, 176, 178, 178, 178, 181, 180, 182, 181, 185, 183, 185, 185, 185, 185, 186 }, { 167, 168, 169, 172, 174, 175, 178, 179, 179, 176, 176, 174, 174, 174, 174, 174, 176, 178, 180, 180, 181, 182, 181, 182, 180, 179, 180, 180 }, { 169, 172, 172, 172, 173, 173, 173, 173, 173, 174, 174, 174, 175, 178, 179, 181, 181, 183, 183, 183, 183, 186, 186, 185, 185, 183, 183, 185 }, { 163, 167, 172, 174, 173, 172, 172, 171, 171, 172, 172, 173, 174, 174, 176, 175, 174, 174, 180, 180, 182, 181, 181, 181, 183, 181, 182, 185 }, { 165, 169, 169, 172, 173, 171, 171, 169, 169, 172, 171, 175, 175, 176, 176, 179, 179, 182, 182, 181, 181, 180, 180, 178, 180, 180, 180, 183 }, { 160, 166, 172, 173, 174, 171, 168, 166, 167, 171, 173, 174, 175, 176, 178, 174, 175, 175, 176, 179, 178, 178, 176, 175, 179, 180, 185, 184 }, { 164, 168, 168, 170, 171, 169, 168, 168, 167, 169, 168, 172, 173, 175, 175, 175, 175, 178, 178, 179, 179, 178, 178, 178, 179, 178, 178, 181 }, { 161, 161, 168, 168, 171, 167, 164, 164, 165, 166, 168, 170, 172, 173, 173, 173, 173, 175, 174, 174, 171, 172, 171, 171, 174, 173, 178, 177 }, { 165, 167, 167, 166, 167, 164, 165, 166, 166, 167, 166, 167, 168, 172, 172, 173, 172, 173, 173, 173, 174, 174, 174, 179, 180, 179, 178, 178 }, { 154, 155, 160, 161, 164, 164, 162, 163, 160, 163, 164, 161, 168, 171, 171, 172, 169, 168, 168, 171, 171, 170, 172, 172, 175, 174, 173, 173 }, { 155, 159, 159, 159, 160, 159, 160, 164, 164, 165, 162, 164, 163, 170, 168, 168, 168, 168, 169, 167, 167, 172, 171, 175, 175, 175, 175, 174 }, { 154, 154, 158, 159, 159, 159, 162, 162, 166, 167, 165, 166, 166, 165, 164, 164, 166, 167, 168, 171, 169, 171, 173, 172, 172, 173, 172, 171 }, { 152, 155, 158, 159, 159, 159, 158, 161, 160, 164, 164, 164, 164, 168, 168, 168, 169, 166, 167, 169, 168, 170, 170, 167, 168, 170, 170, 171 }, { 159, 160, 160, 158, 156, 154, 159, 160, 162, 163, 160, 161, 159, 160, 164, 166, 169, 172, 171, 171, 168, 168, 171, 168, 171, 170, 168, 171 }, { 157, 161, 162, 160, 161, 154, 157, 158, 157, 161, 159, 165, 165, 167, 165, 165, 164, 168, 166, 170, 168, 168, 168, 164, 165, 167, 166, 171 }, { 160, 160, 159, 160, 159, 157, 158, 158, 158, 159, 160, 160, 161, 163, 166, 167, 168, 168, 168, 168, 167, 168, 169, 169, 169, 167, 168, 170 }, { 158, 161, 161, 161, 163, 157, 159, 157, 154, 158, 157, 165, 165, 167, 166, 161, 161, 166, 165, 166, 166, 170, 170, 168, 169, 167, 168, 171 }, { 154, 157, 153, 155, 161, 161, 161, 158, 158, 161, 162, 163, 159, 159, 163, 163, 163, 165, 164, 164, 167, 170, 170, 171, 169, 168, 168, 168 }, { 151, 154, 154, 160, 160, 161, 161, 158, 157, 159, 159, 165, 164, 162, 162, 160, 161, 164, 164, 166, 165, 170, 171, 172, 174, 171, 171, 171 }, { 149, 152, 152, 152, 155, 152, 156, 156, 159, 161, 160, 160, 158, 157, 162, 161, 164, 166, 162, 164, 164, 165, 166, 168, 165, 167, 167, 167 }, { 147, 150, 150, 157, 157, 157, 156, 159, 158, 160, 160, 160, 160, 158, 159, 160, 161, 165, 162, 166, 165, 167, 168, 171, 171, 167, 167, 170 }, { 148, 151, 153, 157, 153, 154, 155, 157, 159, 158, 158, 157, 159, 160, 162, 160, 162, 162, 165, 166, 165, 165, 162, 161, 160, 161, 164, 164 }, { 147, 151, 150, 154, 156, 151, 152, 157, 159, 163, 161, 155, 155, 156, 158, 161, 163, 167, 167, 167, 167, 166, 167, 169, 169, 171, 169, 171 } };
            */

            int[,] brightness = new int[COLUMNS, ROWS];

            Random r = new Random();

            for (j = 0; j < ROWS; j++)
            {
                for (i = 0; i < COLUMNS; i++)
                {
                    brightness[i, j] = r.Next(1, 160);
                }
            }

            //brightness = new int[,] { { 166, 158, 154, 151, 150, 150, 152, 145, 143, 136, 131, 131, 131, 129, 128, 124, 123, 118, 119, 119 }, { 159, 159, 153, 153, 152, 153, 146, 146, 137, 146, 129, 116, 115, 114, 117, 116, 122, 122, 122, 122 }, { 159, 153, 152, 147, 148, 145, 143, 134, 132, 127, 123, 114, 116, 117, 117, 122, 123, 130, 132, 130 }, { 153, 153, 150, 148, 145, 144, 136, 133, 127, 127, 124, 121, 115, 115, 115, 115, 121, 123, 125, 125 }, { 138, 140, 140, 143, 143, 139, 137, 129, 126, 121, 122, 118, 118, 118, 121, 121, 118, 124, 125, 124 }, { 140, 142, 145, 144, 144, 142, 131, 129, 123, 123, 123, 123, 123, 123, 118, 117, 116, 116, 117, 118 }, { 139, 140, 139, 140, 139, 133, 130, 128, 126, 129, 130, 129, 126, 119, 118, 116, 115, 114, 114, 114 }, { 144, 144, 140, 142, 139, 139, 132, 131, 128, 128, 124, 125, 123, 123, 118, 117, 115, 115, 114, 114 }, { 145, 140, 139, 136, 135, 130, 128, 126, 128, 130, 130, 127, 123, 118, 117, 116, 117, 116, 112, 109 }, { 148, 147, 137, 124, 128, 128, 130, 130, 131, 132, 129, 130, 122, 121, 118, 118, 107, 122, 116, 121 }, { 153, 146, 139, 132, 129, 125, 124, 126, 128, 131, 131, 128, 125, 123, 123, 116, 125, 132, 148, 166 }, { 152, 152, 142, 129, 128, 128, 130, 130, 134, 135, 136, 136, 132, 129, 126, 126, 136, 147, 151, 154 }, { 152, 150, 150, 140, 136, 130, 129, 130, 132, 135, 138, 132, 137, 136, 136, 137, 136, 142, 139, 139 }, { 149, 150, 145, 144, 137, 137, 138, 138, 143, 144, 146, 145, 142, 143, 139, 142, 141, 141, 143, 143 }, { 145, 144, 147, 142, 144, 139, 138, 140, 144, 150, 152, 153, 153, 150, 147, 142, 138, 142, 139, 138 }, { 140, 139, 140, 142, 145, 145, 145, 146, 152, 152, 156, 154, 157, 156, 154, 154, 147, 147, 143, 142 }, { 144, 140, 140, 142, 145, 147, 147, 151, 153, 159, 160, 164, 163, 160, 158, 158, 158, 152, 143, 136 }, { 137, 136, 138, 138, 146, 145, 150, 150, 156, 157, 164, 162, 161, 160, 160, 160, 161, 159, 151, 151 }, { 124, 129, 144, 148, 150, 152, 151, 152, 154, 159, 158, 163, 161, 159, 158, 158, 161, 162, 166, 179 }, { 141, 144, 151, 151, 151, 151, 154, 154, 158, 158, 161, 160, 158, 157, 155, 153, 168, 165, 167, 169 } };

            richTextBox1.Text += "brightness rank" + brightness.Rank.ToString() + "\n";

            for (i = 0; i < brightness.Rank; i++)
            {
                richTextBox1.Text += "aaaa = " + brightness.GetLength(i) + "\n";
            }

            for (j = 0; j < ROWS; j++)
            {
                for (i = 0; i < COLUMNS; i++)
                {
                    brightness[i, j] = r.Next(1, 160);

                    //richTextBox1.Text += brightness[j, i].ToString() + " ";
                    if (max < brightness[i, j])
                        max = brightness[i, j];
                    else if (min > brightness[i, j])
                        min = brightness[i, j];
                    total += brightness[i, j];
                }
                //richTextBox1.Text += "\n";
            }

            richTextBox1.Text += "max = " + max.ToString() + "\n";
            richTextBox1.Text += "min = " + min.ToString() + "\n";
            average = total / (COLUMNS * ROWS);
            richTextBox1.Text += "average = " + average.ToString() + "\n";

            for (j = 0; j < ROWS; j++)
            {
                for (i = 0; i < COLUMNS; i++)
                {
                    rms += (brightness[i, j] - average) * (brightness[i, j] - average);
                }
            }

            rms /= COLUMNS * ROWS;

            richTextBox1.Text += "rms = " + Math.Sqrt((double)rms).ToString() + "\n";

            //width = 14 * COLUMNS;
            //height = 10 * ROWS;


            Bitmap bitmap1 = new Bitmap(W, H);


            byte aa = 255;
            byte rr = 0;
            byte gg = 0;
            byte bb = 0;
            int dd = 20;
            int diff;
            if (max == min)
                diff = 1;
            else
                diff = max - min;

            for (yy = 0; yy < H; yy++)
            {
                for (xx = 0; xx < W; xx++)
                {
                    //設置像素的ＲＧＢ顏色值
                    rr = (byte)((brightness[xx / dd, yy / dd] - min) * 255 / diff);
                    gg = (byte)((brightness[xx / dd, yy / dd] - min) * 255 / diff);
                    bb = (byte)((brightness[xx / dd, yy / dd] - min) * 255 / diff);
                    bitmap1.SetPixel(xx, yy, Color.FromArgb(aa, rr, gg, bb));
                }
            }
            pictureBox1.Image = bitmap1;
        }

        private void timer1_Tick(object sender, EventArgs e)
        {
            draw_random_2d_array();
        }
        //for pictureBox1 SP

        private void timer2_Tick(object sender, EventArgs e)
        {

        }

        private void timer3_Tick(object sender, EventArgs e)
        {

        }

        private void timer4_Tick(object sender, EventArgs e)
        {

        }

        private void timer5_Tick(object sender, EventArgs e)
        {

        }

        private void timer6_Tick(object sender, EventArgs e)
        {

        }

        private void timer7_Tick(object sender, EventArgs e)
        {

        }

        private void timer8_Tick(object sender, EventArgs e)
        {

        }

        private void timer9_Tick(object sender, EventArgs e)
        {

        }

        //for random color ST
        void draw_random_color()
        {
            int x_st = 10;
            int y_st = 670;
            int WIDTH = 40;
            for (int i = 1; i < lb_color.Length; i++)
            {
                lb_color[i] = new Label();
                lb_color[i].Width = WIDTH;
                lb_color[i].Height = WIDTH;
                lb_color[i].Text = " ";
                lb_color[i].Location = new Point(x_st + lb_color_x, y_st + lb_color_y);
                _R = r.Next(256);
                _G = r.Next(256);
                _B = r.Next(256);
                lb_color[i].BackColor = Color.FromArgb(_R, _G, _B);
                this.Controls.Add(lb_color[i]);
                lb_color_x += WIDTH;

                if (i % 10 == 0)
                {
                    lb_color_x = 0;
                    lb_color_y += WIDTH;
                }
            }
            timer10.Enabled = true;
        }

        private void timer10_Tick(object sender, EventArgs e)
        {
            for (int i = 1; i < lb_color.Length; i++)
            {
                _R = r.Next(256);
                _G = r.Next(256);
                _B = r.Next(256);
                lb_color[i].BackColor = Color.FromArgb(_R, _G, _B);
            }

        }
        //for random color SP
    }
}

